---
source: apollo-router/tests/set_context.rs
expression: response
---
{
  "data": {
    "k": {
      "v": {
        "field": 3456
      }
    }
  },
  "extensions": {
    "apolloQueryPlan": {
      "object": {
        "kind": "QueryPlan",
        "node": {
          "kind": "Sequence",
          "nodes": [
            {
              "kind": "Fetch",
              "serviceName": "Subgraph1",
              "variableUsages": [],
              "operation": "query QueryUnion__Subgraph1__0{k{__typename ...on A{prop v{__typename id}}...on B{prop v{__typename id}}}}",
              "operationName": "QueryUnion__Subgraph1__0",
              "operationKind": "query",
              "id": null,
              "inputRewrites": null,
              "outputRewrites": null,
              "contextRewrites": null,
              "schemaAwareHash": "0f1ba6ea48b6f8adfc469d87012031090fe5de3f5ba9de8a8823a2d139c0370e",
              "authorization": {
                "is_authenticated": false,
                "scopes": [],
                "policies": []
              }
            },
            {
              "kind": "Parallel",
              "nodes": [
                {
                  "kind": "Flatten",
                  "path": [
                    "",
                    "k|[A]",
                    "v"
                  ],
                  "node": {
                    "kind": "Fetch",
                    "serviceName": "Subgraph1",
                    "requires": [
                      {
                        "kind": "InlineFragment",
                        "typeCondition": "V",
                        "selections": [
                          {
                            "kind": "Field",
                            "name": "__typename"
                          },
                          {
                            "kind": "Field",
                            "name": "id"
                          }
                        ]
                      }
                    ],
                    "variableUsages": [
                      "contextualArgument_1_1"
                    ],
                    "operation": "query QueryUnion__Subgraph1__1($representations:[_Any!]!$contextualArgument_1_1:String!){_entities(representations:$representations){...on V{field(a:$contextualArgument_1_1)}}}",
                    "operationName": "QueryUnion__Subgraph1__1",
                    "operationKind": "query",
                    "id": null,
                    "inputRewrites": null,
                    "outputRewrites": null,
                    "contextRewrites": [
                      {
                        "kind": "KeyRenamer",
                        "path": [
                          "..",
                          "... on A",
                          "prop"
                        ],
                        "renameKeyTo": "contextualArgument_1_1"
                      }
                    ],
                    "schemaAwareHash": "9ecc4a9a1ef31dd054ca44d1fa6cf12ca2198604116f40eb5a2dd0411454ce47",
                    "authorization": {
                      "is_authenticated": false,
                      "scopes": [],
                      "policies": []
                    }
                  }
                },
                {
                  "kind": "Flatten",
                  "path": [
                    "",
                    "k|[B]",
                    "v"
                  ],
                  "node": {
                    "kind": "Fetch",
                    "serviceName": "Subgraph1",
                    "requires": [
                      {
                        "kind": "InlineFragment",
                        "typeCondition": "V",
                        "selections": [
                          {
                            "kind": "Field",
                            "name": "__typename"
                          },
                          {
                            "kind": "Field",
                            "name": "id"
                          }
                        ]
                      }
                    ],
                    "variableUsages": [
                      "contextualArgument_1_1"
                    ],
                    "operation": "query QueryUnion__Subgraph1__2($representations:[_Any!]!$contextualArgument_1_1:String!){_entities(representations:$representations){...on V{field(a:$contextualArgument_1_1)}}}",
                    "operationName": "QueryUnion__Subgraph1__2",
                    "operationKind": "query",
                    "id": null,
                    "inputRewrites": null,
                    "outputRewrites": null,
                    "contextRewrites": [
                      {
                        "kind": "KeyRenamer",
                        "path": [
                          "..",
                          "... on B",
                          "prop"
                        ],
                        "renameKeyTo": "contextualArgument_1_1"
                      }
                    ],
                    "schemaAwareHash": "0a393294385fd932d1123d1fe054146f9fcd25dd927b02a72beecb2d6c3d867e",
                    "authorization": {
                      "is_authenticated": false,
                      "scopes": [],
                      "policies": []
                    }
                  }
                }
              ]
            }
          ]
        }
      },
      "text": "QueryPlan {\n  Sequence {\n    Fetch(service: \"Subgraph1\") {\n      {\n        k {\n          __typename\n          ... on A {\n            prop\n            v {\n              __typename\n              id\n            }\n          }\n          ... on B {\n            prop\n            v {\n              __typename\n              id\n            }\n          }\n        }\n      }\n    },\n    Parallel {\n      Flatten(path: \".k|[A].v\") {\n        Fetch(service: \"Subgraph1\") {\n          {\n            ... on V {\n              __typename\n              id\n            }\n          } =>\n          {\n            ... on V {\n              field(a: $contextualArgument_1_1)\n            }\n          }\n        },\n      },\n      Flatten(path: \".k|[B].v\") {\n        Fetch(service: \"Subgraph1\") {\n          {\n            ... on V {\n              __typename\n              id\n            }\n          } =>\n          {\n            ... on V {\n              field(a: $contextualArgument_1_1)\n            }\n          }\n        },\n      },\n    },\n  },\n}"
    }
  }
}
