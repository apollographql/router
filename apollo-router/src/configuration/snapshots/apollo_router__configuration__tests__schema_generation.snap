---
source: apollo-router/src/configuration/mod.rs
assertion_line: 474
expression: "&schema"

---
{
  "$schema": "https://json-schema.org/draft/2019-09/schema",
  "title": "Configuration",
  "description": "The configuration for the router. Currently maintains a mapping of subgraphs.",
  "type": "object",
  "properties": {
    "plugins": {
      "description": "Plugin configuration",
      "default": {},
      "$ref": "#/definitions/Plugins"
    },
    "server": {
      "description": "Configuration options pertaining to the http server component.",
      "default": {
        "listen": "127.0.0.1:4000",
        "cors": null
      },
      "$ref": "#/definitions/Server"
    },
    "subgraphs": {
      "description": "Mapping of name to subgraph that the router may contact.",
      "default": {},
      "type": "object",
      "additionalProperties": {
        "$ref": "#/definitions/Subgraph"
      }
    }
  },
  "additionalProperties": false,
  "definitions": {
    "Conf": {
      "type": "object",
      "required": [
        "name"
      ],
      "properties": {
        "name": {
          "type": "string"
        }
      }
    },
    "Cors": {
      "description": "Cross origin request configuration.",
      "type": "object",
      "properties": {
        "allow_any_origin": {
          "description": "Set to false to disallow any origin and rely exclusively on `origins`.\n\n/!\\ Defaults to true Having this set to true is the only way to allow Origin: null.",
          "default": null,
          "type": "boolean",
          "nullable": true
        },
        "allow_credentials": {
          "description": "Set to true to add the `Access-Control-Allow-Credentials` header.",
          "default": null,
          "type": "boolean",
          "nullable": true
        },
        "allow_headers": {
          "description": "The headers to allow. Defaults to the required request header for Apollo Studio",
          "default": [
            "Content-Type"
          ],
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "expose_headers": {
          "description": "Which response headers should be made available to scripts running in the browser, in response to a cross-origin request.",
          "default": null,
          "type": "array",
          "items": {
            "type": "string"
          },
          "nullable": true
        },
        "methods": {
          "description": "Allowed request methods. Defaults to GET, POST, OPTIONS.",
          "default": [
            "GET",
            "POST",
            "OPTIONS"
          ],
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "origins": {
          "description": "The origin(s) to allow requests from. Use `https://studio.apollographql.com/` to allow Apollo Studio to function.",
          "default": [],
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "additionalProperties": false
    },
    "InsertConfig": {
      "type": "object",
      "required": [
        "name",
        "value"
      ],
      "properties": {
        "name": {
          "type": "string"
        },
        "value": {
          "type": "string"
        }
      }
    },
    "ListenAddr": {
      "description": "Listening address.",
      "anyOf": [
        {
          "description": "Socket address.",
          "type": "string"
        },
        {
          "description": "Unix socket.",
          "type": "string"
        }
      ]
    },
    "Plugins": {
      "anyOf": [
        {
          "required": [
            "com.apollographql.reporting"
          ]
        },
        {
          "required": [
            "com.apollographql.test.always_fails_to_start"
          ]
        },
        {
          "required": [
            "com.apollographql.test.always_fails_to_start_and_stop"
          ]
        },
        {
          "required": [
            "com.apollographql.test.always_fails_to_stop"
          ]
        },
        {
          "required": [
            "com.apollographql.test.always_starts_and_stops"
          ]
        },
        {
          "required": [
            "com.example.hello"
          ]
        }
      ],
      "properties": {
        "com.apollographql.reporting": {
          "$ref": "#/definitions/Conf"
        },
        "com.apollographql.test.always_fails_to_start": {
          "$ref": "#/definitions/Conf"
        },
        "com.apollographql.test.always_fails_to_start_and_stop": {
          "$ref": "#/definitions/Conf"
        },
        "com.apollographql.test.always_fails_to_stop": {
          "$ref": "#/definitions/Conf"
        },
        "com.apollographql.test.always_starts_and_stops": {
          "$ref": "#/definitions/Conf"
        },
        "com.example.hello": {
          "$ref": "#/definitions/Conf"
        }
      }
    },
    "PropagateConfig": {
      "oneOf": [
        {
          "type": "object",
          "required": [
            "matching"
          ],
          "properties": {
            "matching": {
              "type": "object",
              "properties": {
                "regex": {
                  "default": ".*",
                  "type": "string"
                }
              }
            }
          },
          "additionalProperties": false
        },
        {
          "type": "object",
          "required": [
            "named"
          ],
          "properties": {
            "named": {
              "type": "object",
              "required": [
                "name"
              ],
              "properties": {
                "default_value": {
                  "type": "string",
                  "nullable": true
                },
                "name": {
                  "type": "string"
                },
                "rename": {
                  "type": "string",
                  "nullable": true
                }
              }
            }
          },
          "additionalProperties": false
        }
      ]
    },
    "RemoveConfig": {
      "oneOf": [
        {
          "type": "object",
          "required": [
            "name"
          ],
          "properties": {
            "name": {
              "type": "string"
            }
          },
          "additionalProperties": false
        },
        {
          "type": "object",
          "required": [
            "matching"
          ],
          "properties": {
            "matching": {
              "type": "object",
              "properties": {
                "regex": {
                  "default": ".*",
                  "type": "string"
                }
              }
            }
          },
          "additionalProperties": false
        }
      ]
    },
    "Server": {
      "description": "Configuration options pertaining to the http server component.",
      "type": "object",
      "properties": {
        "cors": {
          "description": "Cross origin request headers.",
          "default": null,
          "$ref": "#/definitions/Cors",
          "nullable": true
        },
        "listen": {
          "description": "The socket address and port to listen on Defaults to 127.0.0.1:4000",
          "default": "127.0.0.1:4000",
          "$ref": "#/definitions/ListenAddr"
        }
      },
      "additionalProperties": false
    },
    "Subgraph": {
      "properties": {
        "layers": {
          "items": {
            "oneOf": [
              {
                "required": [
                  "example.com_hello"
                ]
              },
              {
                "required": [
                  "headers_insert"
                ]
              },
              {
                "required": [
                  "headers_propagate"
                ]
              },
              {
                "required": [
                  "headers_remove"
                ]
              }
            ],
            "properties": {
              "example.com_hello": {
                "$ref": "#/definitions/Conf"
              },
              "headers_insert": {
                "$ref": "#/definitions/InsertConfig"
              },
              "headers_propagate": {
                "$ref": "#/definitions/PropagateConfig"
              },
              "headers_remove": {
                "$ref": "#/definitions/RemoveConfig"
              }
            }
          }
        }
      }
    }
  }
}
