---
title: Upgrading from Versions 1.x
subtitle: Upgrade from version 1.x to 2.x of GraphOS Router
description: Learn how to upgrade from version 1.x to 2.x of the GraphOS Router.
---

Learn how to upgrade from your GraphOS Router 1.x deployment to GraphOS Router 2.x.

## What's different?

### New Features

There are new features in GraphOS Router v2.0 (Alpha). Think about how you can take advantage of these as you plan your upgrade to your existing 1.x deployment.

### Apollo Reporting

Prior to version 1.49.0 of the router, all GraphOS reporting was performed using a [private tracing format](graphos/metrics/sending-operation-metrics#reporting-format).

In 1.49.0, we introduced support for using OTEL to perform this reporting.

In 1.x, this is controlled using the `experimental_otlp_tracing_sampler` flag, and is disabled by default.

In 2.x, this flag is now renamed to `otlp_tracing_sampler`, and is enabled by default.

TBD: I can't find any references to where this is documented apart from the CHANGELOG Entry for 1.49.0. I've reproduced that text here for now.
TBD: Ideally this would be a separate page that we reference...

This flag can be used to send a percentage of traces via OTLP instead of the native Apollo Usage Reporting protocol. Supported values:

Prior to version 1.49.0 of the router, all GraphOS reporting was performed using a [private tracing format](graphos/metrics/sending-operation-metrics#reporting-format).

As the ecosystem around OpenTelemetry (OTel) has been expanding rapidly, we are evaluating a migration of Apollo's internal tracing system to use an OTel-based protocol.

In the short-term, benefits include:

- A comprehensive way to visualize the router execution path in GraphOS Studio.
- Additional spans that were previously not included in Studio traces, such as query parsing, planning, execution, and more.
- Additional metadata such as subgraph fetch details, router idle / busy timing, and more.

Long-term, we see this as a strategic enhancement to consolidate these two disparate tracing systems.

This will pave the way for future enhancements to more easily plug into the Studio trace visualizer.

#### Configuration

This change adds a new configuration option `otlp_tracing_sampler`. This can be used to send a percentage of traces via OTLP instead of the native Apollo Usage Reporting protocol. Supported values:

- `always_off`: send all traces via Apollo Usage Reporting protocol.
- `always_on` (default): send all traces via OTLP.
- `0.0 - 1.0`: the ratio of traces to send via OTLP (0.5 = 50 / 50).

Note that this sampler is only applied _after_ the common tracing sampler, for example:

##### Sample 1% of traces, send all traces via OTLP:

```yaml
telemetry:
  apollo:
    # Send all traces via OTLP
    otlp_tracing_sampler: always_on

  exporters:
    tracing:
      common:
        # Sample traces at 1% of all traffic
        sampler: 0.01
```

## How do I upgrade?

Upgrading will generally be quick and painless, but some planning will help.

### Configuration

If you are happy to submit traces via OTEL, then no changes are required. Otherwise, use the `otlp_tracing_sampler` to turn this off.

### Deployment

Make sure that you are referencing the correct router release: v2.0.0-preview.0

During upgrade, carefully monitor resource consumption.

TBD: Write a list of all considerations and possible changes a user must make (configuration, deployment, etc.) to upgrade to 2.x. Add some text here about various changes and how they impact 1.x deployments. Perhaps talk about tooling that automates upgrade (config in particular).

## Reporting upgrade issues

If you encounter an upgrade issue that isn't resolved by this article, please search for existing [GitHub discussions](https://github.com/apollographql/router/discussions/) and start a new discussion if you don't find what you're looking for.
