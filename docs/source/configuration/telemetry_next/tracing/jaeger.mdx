---
title: Tracing in the Apollo Router
description: Collect tracing information
---

import { Link } from "gatsby";


## Jaeger (otlp)

Since 1.35.0, [Jaeger supports native OTLP ingestion](https://medium.com/jaegertracing/introducing-native-support-for-opentelemetry-in-jaeger-eb661be8183c) and this is now the preferred way to send traces to Jaeger.

Ensure that when running Jaeger in docker port 4317 is exposed and that `COLLECTOR_OTLP_ENABLED` is set to `true`:
```bash
docker run --name jaeger \
  -e COLLECTOR_OTLP_ENABLED=true \
  -p 16686:16686 \
  -p 4317:4317 \
  -p 4318:4318 \
  jaegertracing/all-in-one:1.35
```

Then configure the router to send traces via OTLP:
```yaml title="router.yaml"
telemetry:
  tracing:
    otlp:
      enabled: true

      # Optional endpoint, either 'default' or a URL (Defaults to http://127.0.0.1:4317)
      endpoint: "http://${env.JAEGER_HOST}:4317"
```


## Jaeger (native)

> :warning: [Jaeger native is deprecated](https://opentelemetry.io/blog/2022/jaeger-native-otlp/) and will be removed in a future release of the Apollo Router. Instead, [OTLP](#jaeger) should be used.

The Apollo Router can be configured to export tracing data to Jaeger either via an agent or http collector.

Unless explicitly configured to use a collector, Jaeger will use an agent by default.

### Agent config

```yaml title="router.yaml"
telemetry:
  tracing:
    jaeger:
      enabled: true
      # Optional agent configuration,
      agent:
        # Optional endpoint, either 'default' or a socket address (Defaults to 127.0.0.1:6832)
        endpoint: "${env.JAEGER_HOST}:6832"  
```

### Collector config

```yaml title="router.yaml"
telemetry:
  tracing:
    jaeger:
      enabled: true
      # Optional collector configuration,
      collector:
        # Optional endpoint, either 'default' or a URL (Defaults to http://127.0.0.1:14268/api/traces)
        endpoint: "http://${env.JAEGER_HOST}:14268/api/traces"
        username: "${env.JAEGER_USERNAME}"
        password: "${env.JAEGER_PASSWORD}"
```
