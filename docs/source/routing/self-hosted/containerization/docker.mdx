---
title: Deploying the Apollo Runtime in Docker
subtitle: Run an Apollo Runtime container image in Docker
description: Easily deploy a container with everything you need to serve GraphQL requests using Apollo.
---

import ElasticNotice from '../../../../shared/elastic-notice.mdx';

The Apollo Runtime container includes the Apollo Router and MCP Server in a single image. Use this image to deploy GraphQL and MCP capabilities together without building a custom Dockerfile.

You will learn how to:
- Run a basic Apollo Runtime container with default configuration.
- Customize your configuration to override defaults.
- Manually specify a supergraph for your router.

The [documentation](https://docs.docker.com/engine/reference/run/) for the `docker run` command is a helpful reference for the examples in this guide.

## Prerequisites

Before you start:

1. [Set up a GraphQL API in GraphOS](/graphos/get-started/guides/graphql#step-1-set-up-your-graphql-api).
    - Save your `APOLLO_KEY` and `APOLLO_GRAPH_REF`. You'll need them when deploying the router.
1. Install [Docker](https://www.docker.com/get-started/) locally.
1. Choose a container version to deploy (for example, `latest` or a specific version tag). For versioning details, see the [container tags documentation](https://github.com/apollographql/apollo-runtime?tab=readme-ov-file#container-tags).

<ElasticNotice />

## Quick start

Run the router by setting the [`APOLLO_GRAPH_REF`](/graphos/routing/configuration/envvars#apollo_graph_ref) and [`APOLLO_KEY`](/graphos/routing/configuration/envvars#apollo_key) environment variables to your graph ref and API key.

This example runs an Apollo Runtime image with Docker. It downloads your supergraph schema from Apollo and uses a default configuration that listens on port `4000`.

```bash title="Docker"
docker run \
  -p 4000:4000 \
  --env APOLLO_GRAPH_REF="<your-graph-ref>" \
  --env APOLLO_KEY="<your-graph-api-key>" \
  --rm \
  ghcr.io/apollographql/apollo-runtime:latest
```

Replace `<your-graph-ref>` and `<your-graph-api-key>` with your graph reference and API key.

## Enabling MCP

<ExperimentalFeature>

This feature is [experimental](/graphos/resources/feature-launch-stages#experimental). For more information about MCP support,  review the [MCP documentation](https://www.apollographql.com/docs/apollo-mcp-server).

</ExperimentalFeature>

Enable the [MCP server](https://www.apollographql.com/docs/apollo-mcp-server) using the `MCP_ENABLE` environment variable. Export container port `5000` for HTTP Streamable connections to the MCP server with the `-p 5000:5000` flag.

```bash title="Docker" {3, 6}
docker run \
  -p 4000:4000 \
  -p 5000:5000 \
  --env APOLLO_GRAPH_REF="<your-graph-ref>" \
  --env APOLLO_KEY="<your-graph-api-key>" \
  --env MCP_ENABLE=1 \
  --rm \
  ghcr.io/apollographql/apollo-runtime:latest
```

## Configuring using local files

Provide your own configuration by mounting the directory containing your configuration files to `/config`:

```bash title="Docker"
docker run -p 4000:4000 \
  --env APOLLO_GRAPH_REF="<your-graph-ref>" \
  --env APOLLO_KEY="<your-graph-api-key>" \
  -v <<ABSOLUTE_PATH_TO_THE_MY_CONFIG_DIRECTORY>>:/config
  --rm \
  ghcr.io/apollographql/apollo-runtime:<runtime-image-version>
```

Mount specific files, such as the schema file, by specifying:

```bash title="Docker"
...
-v <<ABSOLUTE_PATH_TO_SCHEMA_FILE>:/config/schema.graphql 
...
```

When overriding the default router configuration, preserve the `0.0.0.0` bind address (for all interfaces). This ensures the router is accessible outside the container. Without this, the router only listens on `localhost`.

Use this method for local supergraph schemas, persisted query manifests, router configuration, and more. Learn more in the [configuration documentation](https://github.com/apollographql/apollo-runtime?tab=readme-ov-file#configuring-using-local-files).

<Note>

Both local and container paths must be specified as absolute paths.

</Note>

## Specifying the supergraph

To avoid automatically updating your supergraph via [Apollo Uplink](/federation/managed-federation/uplink/), or if you can't access Apollo Uplink from your environment, use one of these options:

1. Use a local supergraph file, as documented in [Configuring using local files](#configuring-using-local-files).
1. Use a [graph artifact reference](#using-a-graph-artifact-reference).

### Using a graph artifact reference

⚠️ This option is in preview and doesn't support hot-reloading of schemas.

Set the `APOLLO_GRAPH_ARTIFACT_REFERENCE` environment variable to use the supergraph schema from a graph artifact:

```bash
docker run -p 4000:4000 \
  --env APOLLO_KEY="<your-graph-api-key>" \
  --env APOLLO_GRAPH_ARTIFACT_REFERENCE="<your-graph-artifact-reference>" \
  --rm \
  ghcr.io/apollographql/apollo-runtime:<runtime-image-version>
```

The router uses the schema from the specified graph artifact instead of Apollo Uplink. The router still fetches entitlements and persisted queries from Uplink. Learn more in the [Router CLI Configuration Reference](/graphos/routing/configuration/cli#--graph-artifact-reference).

## Running a specific Router and MCP version

The container uses a tagging scheme with three parts: container version, Apollo Router version, and MCP Server version, separated by underscores.

Learn more in the [tagging documentation](https://github.com/apollographql/apollo-runtime?tab=readme-ov-file#container-tags).

## Additional router configuration information

For more complex configurations, such as overriding subgraph URLs or propagating headers, see [Router Configuration](/graphos/routing/configuration/overview/).

## Router-only Docker container

To use a Docker container with only the Apollo Router (without MCP Server), see the [Router-only Docker container documentation](docker-router-only).
