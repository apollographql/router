---
title: Deploying GraphOS Router on Render
subtitle: Deploy router with Render's managed hosting
description: Deploy Apollo GraphOS Router or Apollo Router Core to Render using their managed hosting platform.
---

Learn how to deploy the router on Render's managed hosting platform.

You will:
- Deploy using the Apollo Router template for quick setup
- Configure environment variables and deployment settings
- Customize your deployment with advanced configuration options

## Prerequisites

Before you start:

1. [Set up a GraphQL API in GraphOS](/graphos/get-started/guides/graphql#step-1-set-up-your-graphql-api).
    - Save your `APOLLO_KEY` and `APOLLO_GRAPH_REF`. You'll need them when deploying the router.
1. Create a [Render account](https://render.com/) or use an existing account.
1. Have a GitHub account (for template deployment or custom repository setup).

## Option 1: Quick deployment with template (Recommended)

The fastest way to deploy the Apollo Router on Render is using the official template:

1. **Deploy the template**:
   - Visit the [Apollo Router Template repository](https://github.com/apollographql/router-template)
   - Click the "Deploy to Render" button: [![Deploy to Render](https://render.com/images/deploy-to-render-button.svg)](https://render.com/deploy?repo=github.com/apollographql/router-template)

2. **Configure your service**:
   - **Service Name**: Enter a name for your router service (e.g., `my-apollo-router`)
   - **Branch**: Select `main` (or your preferred branch)

3. **Set environment variables**:
   - `APOLLO_KEY`: Your Graph API key from GraphOS Studio
   - `APOLLO_GRAPH_REF`: Your graph reference (e.g., `my-graph@production`)
   - `PORT`: Set to `4000` (this is already configured in the template)

4. **Deploy**: Click **Create Web Service** to start the deployment.

5. **Verify deployment**: Once deployed, visit your service URL to confirm the router is running. You should see the router's GraphQL Playground or health check endpoint.

## Option 2: Custom deployment

If you need more control over your deployment, you can set up a custom deployment using the Apollo Runtime container:

### Using Apollo Runtime container

The Apollo Runtime container provides a production-ready router with sensible defaults, eliminating the need for complex configuration in most cases.

1. Create a new repository or fork the [router-template](https://github.com/apollographql/router-template) for the following files:

2. (Optional) Create a `router.yaml` configuration file for custom settings:
    
    ```yaml title="router.yaml"
    # The Apollo Runtime container comes with sensible defaults
    # Only create this file if you need custom configuration
    supergraph:
        listen: 0.0.0.0:4000
    health_check:
        listen: 0.0.0.0:8088
    cors:
      # Development setting - replace for production
      allow_any_origin: true
    ```

3. Create a `Dockerfile`:

    ```dockerfile
    # Use the official Apollo Runtime container as the base
    FROM ghcr.io/apollographql/apollo-runtime:0.0.14_router2.5.0_mcp-server0.7.0

    # Optionally copy custom router configuration
    # COPY router.yaml /config/router_config.yaml
    ```

4. Create a `render.yaml` file for Render-specific configuration:

    ```yaml title="render.yaml"
    services:
      - type: web
        name: apollo-router
        runtime: docker
        plan: free  # or starter/standard based on your needs
        envVars:
          - key: APOLLO_GRAPH_REF
            sync: false  # Set this manually in Render dashboard
          - key: APOLLO_KEY
            sync: false  # Set this manually in Render dashboard
          - key: PORT
            value: "4000"
            sync: true
        region: oregon  # or your preferred region
        dockerContext: .
        dockerfilePath: ./Dockerfile
        rootDir: ./
    version: "1"
    ```

### Deploy to Render

1. **Connect your repository**:
   - In your Render dashboard, click **New** > **Web Service**
   - Connect your GitHub repository containing the router configuration

2. **Configure the service**:
   - **Runtime**: Docker
   - **Build Command**: Leave empty (Docker will handle the build)
   - **Start Command**: Leave empty (defined in Dockerfile)

3. **Set environment variables**:
   - Add `APOLLO_KEY` and set it to your Graph API key
   - Add `APOLLO_GRAPH_REF` and set it to your graph reference
   - Add `PORT` and set it to `4000`

4. **Deploy**: Click **Create Web Service**

## Apollo MCP Server

The Apollo Runtime container includes an optional MCP (Model Context Protocol) server that provides AI assistants with structured access to your GraphQL schema and operations.

### Enabling MCP Server

The MCP server is disabled by default. To enable it, set the `MCP_ENABLE` environment variable to `1`:

**In Render dashboard:**
1. Go to your service's **Environment** tab
2. Add `MCP_ENABLE` with value `1`
3. Redeploy your service

**In render.yaml:**
```yaml title="render.yaml"
envVars:
  - key: MCP_ENABLE
    value: "1"
    sync: true
```

### MCP Server Features

When enabled, the MCP server provides:
- Schema introspection capabilities for AI assistants
- Structured access to GraphQL operations  
- Enhanced development experience with AI tools

## Configuration options

### Environment variables

The router accepts several environment variables for configuration:

- `APOLLO_KEY`: Your Graph API key (required)
- `APOLLO_GRAPH_REF`: Your graph reference (required)
- `PORT`: Port for the router to listen on (default: 4000)
- `MCP_ENABLE`: Enable MCP server for AI assistant integration (default: disabled)
- `APOLLO_ROUTER_LOG`: Log level (e.g., `info`, `debug`)

### Health checks

Render automatically configures health checks. The router exposes a health check endpoint at `/health` on port 8088 by default.

### Custom domains

To use a custom domain with your Render deployment:

1. In your Render dashboard, go to your service settings
2. Navigate to the **Custom Domains** section
3. Add your custom domain
4. Configure your DNS to point to Render's provided URL

## Security considerations

**Important security settings to review before production deployment:**

### CORS Configuration
The template includes development-friendly CORS settings that may not be suitable for production:

```yaml title="router.yaml"
cors:
  # Development setting - replace for production
  allow_any_origin: true
  
  # Production setting - specify your domains
  # origins:
  #   - "https://yourdomain.com"
  #   - "https://app.yourdomain.com"
```

### Other security considerations
- **Introspection**: The runtime container disables introspection by default in production
- **Subgraph errors**: All errors are exposed by default (`include_subgraph_errors.all: true`) - consider limiting in production
- **Rate limiting**: Configure appropriate request limits for your use case
- **MCP Server**: Only enable the MCP server (`MCP_ENABLE=1`) in development or trusted environments

## Monitoring and observability

### Render metrics
Render provides built-in metrics for your service including:
- CPU and memory usage
- Request metrics
- Response times

### Router telemetry
The router can export telemetry data to various observability platforms. Configure this in your `router.yaml`:

```yaml title="router.yaml"
telemetry:
  exporters:
    metrics:
      prometheus:
        enabled: true
```

## Scaling

Render automatically handles scaling based on your service plan:
- **Free tier**: Single instance, limited resources
- **Starter**: Single instance with more resources
- **Standard and above**: Auto-scaling capabilities

## Troubleshooting

### Common issues

1. **Service won't start**:
   - Check that `APOLLO_KEY` and `APOLLO_GRAPH_REF` are correctly set
   - Verify your graph exists in GraphOS Studio
   - Check service logs in the Render dashboard

2. **Connection refused errors**:
   - Ensure the router is listening on `0.0.0.0:4000` (not `localhost`)
   - Verify the `PORT` environment variable matches your configuration

3. **GraphOS connection issues**:
   - Verify your `APOLLO_KEY` has the correct permissions
   - Check that your `APOLLO_GRAPH_REF` format is correct (e.g., `graph-name@variant`)

### Getting help

- Check the [Render documentation](https://render.com/docs) for platform-specific issues
- Visit the [Apollo Router documentation](/router) for router configuration
- Review service logs in your Render dashboard
