### General availability of native query planner

The router's native, Rust-based, query planner is now [generally available](https://www.apollographql.com/docs/graphos/reference/feature-launch-stages#general-availability) and enabled by default.

The native query planner achieves better performance for a variety of graphs. In our tests, we observe:

* 10x median improvement in query planning time (observed via `apollo.router.query_planning.plan.duration`)
* 2.9x improvement in router’s CPU utilization
* 2.2x improvement in router’s memory usage 

> Note: you can expect generated plans and subgraph operations in the native
query planner to have slight differences when compared to the legacy, JavaScript-based query planner. We've ascertained these differences to be semantically insignificant, based on comparing ~2.5 million known unique user operations in GraphOS as well as
comparing ~630 million operations across actual router deployments in shadow
mode for a four month duration.

The native query planner supports Federation v2 supergraphs. If you are using Federation v1 today, see our [migration guide](https://www.apollographql.com/docs/graphos/reference/migration/to-federation-version-2) on how to update your composition build step and subgraph changes are typically not needed.

The legacy, JavaScript, query planner is deprecated in this release, but you can still switch
back to it if you are still using Federation v1 supergraph:

```
experimental_query_planner_mode: legacy
```

> Note: The subgraph operations generated by the query planner are not
guaranteed consistent release over release. We strongly recommend against
relying on the shape of planned subgraph operations, as new router features and
optimizations will continuously affect it.

By [@sachindshinde](https://github.com/sachindshinde),
[@goto-bus-stop](https://github.com/goto-bus-stop),
[@duckki](https://github.com/duckki),
[@TylerBloom](https://github.com/TylerBloom),
[@SimonSapin](https://github.com/SimonSapin),
[@dariuszkuc](https://github.com/dariuszkuc),
[@lrlna](https://github.com/lrlna), [@clenfest](https://github.com/clenfest),
and [@o0Ignition0o](https://github.com/o0Ignition0o).