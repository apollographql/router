---
source: apollo-router/src/configuration/tests.rs
expression: "&schema"
---
{
  "$schema": "https://json-schema.org/draft/2019-09/schema",
  "title": "Configuration",
  "description": "The configuration for the router.\n\nCan be created through `serde::Deserialize` from various formats, or inline in Rust code with `serde_json::json!` and `serde_json::from_value`.",
  "type": "object",
  "properties": {
    "cors": {
      "description": "Cross origin request headers.",
      "default": {
        "allow_any_origin": false,
        "allow_credentials": false,
        "allow_headers": [],
        "expose_headers": null,
        "origins": [
          "https://studio.apollographql.com"
        ],
        "match_origins": null,
        "methods": [
          "GET",
          "POST",
          "OPTIONS"
        ]
      },
      "type": "object",
      "properties": {
        "allow_any_origin": {
          "description": "Set to true to allow any origin.\n\nDefaults to false Having this set to true is the only way to allow Origin: null.",
          "default": false,
          "type": "boolean"
        },
        "allow_credentials": {
          "description": "Set to true to add the `Access-Control-Allow-Credentials` header.",
          "default": false,
          "type": "boolean"
        },
        "allow_headers": {
          "description": "The headers to allow.\n\nIf this value is not set, the router will mirror client's `Access-Control-Request-Headers`.\n\nNote that if you set headers here, you also want to have a look at your `CSRF` plugins configuration, and make sure you either: - accept `x-apollo-operation-name` AND / OR `apollo-require-preflight` - defined `csrf` required headers in your yml configuration, as shown in the `examples/cors-and-csrf/custom-headers.router.yaml` files.",
          "default": [],
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "expose_headers": {
          "description": "Which response headers should be made available to scripts running in the browser, in response to a cross-origin request.",
          "default": null,
          "type": "array",
          "items": {
            "type": "string"
          },
          "nullable": true
        },
        "match_origins": {
          "description": "`Regex`es you want to match the origins against to determine if they're allowed. Defaults to an empty list. Note that `origins` will be evaluated before `match_origins`",
          "default": null,
          "type": "array",
          "items": {
            "type": "string"
          },
          "nullable": true
        },
        "methods": {
          "description": "Allowed request methods. Defaults to GET, POST, OPTIONS.",
          "default": [
            "GET",
            "POST",
            "OPTIONS"
          ],
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "origins": {
          "description": "The origin(s) to allow requests from. Defaults to `https://studio.apollographql.com/` for Apollo Studio.",
          "default": [
            "https://studio.apollographql.com"
          ],
          "type": "array",
          "items": {
            "type": "string"
          }
        }
      },
      "additionalProperties": false
    },
    "csrf": {
      "description": "CSRF Configuration.",
      "type": "object",
      "properties": {
        "required_headers": {
          "description": "Override the headers to check for by setting custom_headers Note that if you set required_headers here, you may also want to have a look at your `CORS` configuration, and make sure you either: - did not set any `allow_headers` list (so it defaults to `mirror_request`) - added your required headers to the allow_headers list, as shown in the `examples/cors-and-csrf/custom-headers.router.yaml` files.",
          "default": [
            "x-apollo-operation-name",
            "apollo-require-preflight"
          ],
          "type": "array",
          "items": {
            "type": "string"
          }
        },
        "unsafe_disabled": {
          "description": "The CSRF plugin is enabled by default; set unsafe_disabled = true to disable the plugin behavior Note that setting this to true is deemed unsafe. See <https://developer.mozilla.org/en-US/docs/Glossary/CSRF>.",
          "default": false,
          "type": "boolean"
        }
      },
      "additionalProperties": false
    },
    "forbid_mutations": {
      "type": "boolean"
    },
    "headers": {
      "type": "object",
      "properties": {
        "all": {
          "type": "object",
          "required": [
            "request"
          ],
          "properties": {
            "request": {
              "description": "Propagate/Insert/Remove headers from request",
              "type": "array",
              "items": {
                "oneOf": [
                  {
                    "type": "object",
                    "required": [
                      "insert"
                    ],
                    "properties": {
                      "insert": {
                        "description": "Insert header",
                        "anyOf": [
                          {
                            "description": "Insert static header",
                            "type": "object",
                            "required": [
                              "name",
                              "value"
                            ],
                            "properties": {
                              "name": {
                                "type": "string"
                              },
                              "value": {
                                "type": "string"
                              }
                            },
                            "additionalProperties": false
                          },
                          {
                            "description": "Insert header with a value coming from context key (works only for a string in the context)",
                            "type": "object",
                            "required": [
                              "from_context",
                              "name"
                            ],
                            "properties": {
                              "from_context": {
                                "description": "Specify context key to fetch value",
                                "type": "string"
                              },
                              "name": {
                                "description": "Specify header name",
                                "type": "string"
                              }
                            },
                            "additionalProperties": false
                          },
                          {
                            "description": "Insert header with a value coming from body",
                            "type": "object",
                            "required": [
                              "name",
                              "path"
                            ],
                            "properties": {
                              "default": {
                                "type": "string",
                                "nullable": true
                              },
                              "name": {
                                "type": "string"
                              },
                              "path": {
                                "type": "string"
                              }
                            },
                            "additionalProperties": false
                          }
                        ]
                      }
                    },
                    "additionalProperties": false
                  },
                  {
                    "type": "object",
                    "required": [
                      "remove"
                    ],
                    "properties": {
                      "remove": {
                        "description": "Remove header",
                        "oneOf": [
                          {
                            "description": "Remove a header given a header name",
                            "type": "object",
                            "required": [
                              "named"
                            ],
                            "properties": {
                              "named": {
                                "type": "string"
                              }
                            },
                            "additionalProperties": false
                          },
                          {
                            "description": "Remove a header given a regex matching header name",
                            "type": "object",
                            "required": [
                              "matching"
                            ],
                            "properties": {
                              "matching": {
                                "type": "string"
                              }
                            },
                            "additionalProperties": false
                          }
                        ]
                      }
                    },
                    "additionalProperties": false
                  },
                  {
                    "type": "object",
                    "required": [
                      "propagate"
                    ],
                    "properties": {
                      "propagate": {
                        "description": "Propagate header",
                        "anyOf": [
                          {
                            "description": "Propagate header given a header name",
                            "type": "object",
                            "required": [
                              "named"
                            ],
                            "properties": {
                              "default": {
                                "type": "string",
                                "nullable": true
                              },
                              "named": {
                                "type": "string"
                              },
                              "rename": {
                                "type": "string",
                                "nullable": true
                              }
                            },
                            "additionalProperties": false
                          },
                          {
                            "description": "Propagate header given a regex to match header name",
                            "type": "object",
                            "required": [
                              "matching"
                            ],
                            "properties": {
                              "matching": {
                                "type": "string"
                              }
                            },
                            "additionalProperties": false
                          }
                        ]
                      }
                    },
                    "additionalProperties": false
                  }
                ]
              }
            }
          },
          "additionalProperties": false,
          "nullable": true
        },
        "subgraphs": {
          "type": "object",
          "additionalProperties": {
            "type": "object",
            "required": [
              "request"
            ],
            "properties": {
              "request": {
                "description": "Propagate/Insert/Remove headers from request",
                "type": "array",
                "items": {
                  "oneOf": [
                    {
                      "type": "object",
                      "required": [
                        "insert"
                      ],
                      "properties": {
                        "insert": {
                          "description": "Insert header",
                          "anyOf": [
                            {
                              "description": "Insert static header",
                              "type": "object",
                              "required": [
                                "name",
                                "value"
                              ],
                              "properties": {
                                "name": {
                                  "type": "string"
                                },
                                "value": {
                                  "type": "string"
                                }
                              },
                              "additionalProperties": false
                            },
                            {
                              "description": "Insert header with a value coming from context key (works only for a string in the context)",
                              "type": "object",
                              "required": [
                                "from_context",
                                "name"
                              ],
                              "properties": {
                                "from_context": {
                                  "description": "Specify context key to fetch value",
                                  "type": "string"
                                },
                                "name": {
                                  "description": "Specify header name",
                                  "type": "string"
                                }
                              },
                              "additionalProperties": false
                            },
                            {
                              "description": "Insert header with a value coming from body",
                              "type": "object",
                              "required": [
                                "name",
                                "path"
                              ],
                              "properties": {
                                "default": {
                                  "type": "string",
                                  "nullable": true
                                },
                                "name": {
                                  "type": "string"
                                },
                                "path": {
                                  "type": "string"
                                }
                              },
                              "additionalProperties": false
                            }
                          ]
                        }
                      },
                      "additionalProperties": false
                    },
                    {
                      "type": "object",
                      "required": [
                        "remove"
                      ],
                      "properties": {
                        "remove": {
                          "description": "Remove header",
                          "oneOf": [
                            {
                              "description": "Remove a header given a header name",
                              "type": "object",
                              "required": [
                                "named"
                              ],
                              "properties": {
                                "named": {
                                  "type": "string"
                                }
                              },
                              "additionalProperties": false
                            },
                            {
                              "description": "Remove a header given a regex matching header name",
                              "type": "object",
                              "required": [
                                "matching"
                              ],
                              "properties": {
                                "matching": {
                                  "type": "string"
                                }
                              },
                              "additionalProperties": false
                            }
                          ]
                        }
                      },
                      "additionalProperties": false
                    },
                    {
                      "type": "object",
                      "required": [
                        "propagate"
                      ],
                      "properties": {
                        "propagate": {
                          "description": "Propagate header",
                          "anyOf": [
                            {
                              "description": "Propagate header given a header name",
                              "type": "object",
                              "required": [
                                "named"
                              ],
                              "properties": {
                                "default": {
                                  "type": "string",
                                  "nullable": true
                                },
                                "named": {
                                  "type": "string"
                                },
                                "rename": {
                                  "type": "string",
                                  "nullable": true
                                }
                              },
                              "additionalProperties": false
                            },
                            {
                              "description": "Propagate header given a regex to match header name",
                              "type": "object",
                              "required": [
                                "matching"
                              ],
                              "properties": {
                                "matching": {
                                  "type": "string"
                                }
                              },
                              "additionalProperties": false
                            }
                          ]
                        }
                      },
                      "additionalProperties": false
                    }
                  ]
                }
              }
            },
            "additionalProperties": false
          }
        }
      },
      "additionalProperties": false
    },
    "health-check": {
      "description": "Configuration options pertaining to the http server component.",
      "default": {
        "listen": "127.0.0.1:8088",
        "enabled": true
      },
      "type": "object",
      "properties": {
        "enabled": {
          "default": true,
          "type": "boolean"
        },
        "listen": {
          "description": "The socket address and port to listen on Defaults to 127.0.0.1:8088",
          "default": "127.0.0.1:8088",
          "anyOf": [
            {
              "description": "Socket address.",
              "type": "string"
            },
            {
              "description": "Unix socket.",
              "type": "string"
            }
          ]
        }
      },
      "additionalProperties": false
    },
    "homepage": {
      "description": "Configuration options pertaining to the home page.",
      "default": {
        "enabled": true
      },
      "type": "object",
      "properties": {
        "enabled": {
          "default": true,
          "type": "boolean"
        }
      },
      "additionalProperties": false
    },
    "include_subgraph_errors": {
      "type": "object",
      "properties": {
        "all": {
          "default": false,
          "type": "boolean"
        },
        "subgraphs": {
          "default": {},
          "type": "object",
          "additionalProperties": {
            "type": "boolean"
          }
        }
      },
      "additionalProperties": false
    },
    "override_subgraph_url": {
      "type": "object",
      "additionalProperties": {
        "type": "string",
        "format": "uri"
      }
    },
    "plugins": {
      "description": "Plugin configuration",
      "default": null,
      "properties": {
        "experimental.expose_query_plan": {
          "type": "boolean"
        }
      },
      "additionalProperties": false
    },
    "rhai": {
      "description": "Configuration for the Rhai Plugin",
      "type": "object",
      "properties": {
        "main": {
          "type": "string",
          "nullable": true
        },
        "scripts": {
          "type": "string",
          "nullable": true
        }
      },
      "additionalProperties": false
    },
    "sandbox": {
      "description": "Configuration options pertaining to the sandbox page.",
      "default": {
        "enabled": false
      },
      "type": "object",
      "properties": {
        "enabled": {
          "default": false,
          "type": "boolean"
        }
      },
      "additionalProperties": false
    },
    "server": {
      "description": "Configuration options pertaining to the http server component.",
      "default": {
        "experimental_parser_recursion_limit": 4096
      },
      "type": "object",
      "properties": {
        "experimental_parser_recursion_limit": {
          "description": "Experimental limitation of query depth default: 4096",
          "default": 4096,
          "type": "integer",
          "format": "uint",
          "minimum": 0.0
        }
      },
      "additionalProperties": false
    },
    "supergraph": {
      "description": "Configuration options pertaining to the supergraph server component.",
      "default": {
        "listen": "127.0.0.1:4000",
        "path": "/",
        "introspection": false,
        "preview_defer_support": true
      },
      "type": "object",
      "properties": {
        "introspection": {
          "description": "Enable introspection Default: false",
          "default": false,
          "type": "boolean"
        },
        "listen": {
          "description": "The socket address and port to listen on Defaults to 127.0.0.1:4000",
          "default": "127.0.0.1:4000",
          "anyOf": [
            {
              "description": "Socket address.",
              "type": "string"
            },
            {
              "description": "Unix socket.",
              "type": "string"
            }
          ]
        },
        "path": {
          "description": "The HTTP path on which GraphQL requests will be served. default: \"/\"",
          "default": "/",
          "type": "string"
        },
        "preview_defer_support": {
          "default": true,
          "type": "boolean"
        }
      },
      "additionalProperties": false
    },
    "telemetry": {
      "type": "object",
      "properties": {
        "apollo": {
          "type": "object",
          "properties": {
            "buffer_size": {
              "description": "The buffer size for sending traces to Apollo. Increase this if you are experiencing lost traces.",
              "default": 10000,
              "type": "integer",
              "format": "uint",
              "minimum": 0.0
            },
            "client_name_header": {
              "description": "The name of the header to extract from requests when populating 'client nane' for traces and metrics in Apollo Studio.",
              "default": "apollographql-client-name",
              "type": "string",
              "nullable": true
            },
            "client_version_header": {
              "description": "The name of the header to extract from requests when populating 'client version' for traces and metrics in Apollo Studio.",
              "default": "apollographql-client-version",
              "type": "string",
              "nullable": true
            },
            "endpoint": {
              "description": "The Apollo Studio endpoint for exporting traces and metrics.",
              "type": "string",
              "nullable": true
            },
            "field_level_instrumentation_sampler": {
              "description": "Enable field level instrumentation for subgraphs via ftv1. ftv1 tracing can cause performance issues as it is transmitted in band with subgraph responses. 0.0 will result in no field level instrumentation. 1.0 will result in always instrumentation. Value MUST be less than global sampling rate",
              "anyOf": [
                {
                  "description": "Sample a given fraction. Fractions >= 1 will always sample.",
                  "type": "number",
                  "format": "double"
                },
                {
                  "oneOf": [
                    {
                      "description": "Always sample",
                      "type": "string",
                      "enum": [
                        "always_on"
                      ]
                    },
                    {
                      "description": "Never sample",
                      "type": "string",
                      "enum": [
                        "always_off"
                      ]
                    }
                  ]
                }
              ],
              "nullable": true
            },
            "send_headers": {
              "description": "To configure which request header names and values are included in trace data that's sent to Apollo Studio.",
              "oneOf": [
                {
                  "type": "string",
                  "enum": [
                    "none",
                    "all"
                  ]
                },
                {
                  "type": "object",
                  "required": [
                    "only"
                  ],
                  "properties": {
                    "only": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "required": [
                    "except"
                  ],
                  "properties": {
                    "except": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                }
              ]
            },
            "send_variable_values": {
              "description": "To configure which GraphQL variable values are included in trace data that's sent to Apollo Studio",
              "oneOf": [
                {
                  "type": "string",
                  "enum": [
                    "none",
                    "all"
                  ]
                },
                {
                  "type": "object",
                  "required": [
                    "only"
                  ],
                  "properties": {
                    "only": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "required": [
                    "except"
                  ],
                  "properties": {
                    "except": {
                      "type": "array",
                      "items": {
                        "type": "string"
                      }
                    }
                  },
                  "additionalProperties": false
                }
              ]
            }
          },
          "additionalProperties": false,
          "nullable": true
        },
        "metrics": {
          "type": "object",
          "properties": {
            "common": {
              "type": "object",
              "properties": {
                "attributes": {
                  "description": "Configuration to add custom labels/attributes to metrics",
                  "type": "object",
                  "properties": {
                    "router": {
                      "description": "Configuration to forward header values or body values from router request/response in metric attributes/labels",
                      "type": "object",
                      "properties": {
                        "context": {
                          "description": "Configuration to forward values from the context to custom attributes/labels in metrics",
                          "type": "array",
                          "items": {
                            "description": "Configuration to forward context values in metric attributes/labels",
                            "type": "object",
                            "required": [
                              "named"
                            ],
                            "properties": {
                              "default": {
                                "type": "string",
                                "nullable": true
                              },
                              "named": {
                                "type": "string"
                              },
                              "rename": {
                                "type": "string",
                                "nullable": true
                              }
                            },
                            "additionalProperties": false
                          },
                          "nullable": true
                        },
                        "errors": {
                          "description": "Configuration to forward values from the error to custom attributes/labels in metrics",
                          "type": "object",
                          "properties": {
                            "extensions": {
                              "description": "Forward extensions values as custom attributes/labels in metrics",
                              "type": "array",
                              "items": {
                                "description": "Configuration to forward body values in metric attributes/labels",
                                "type": "object",
                                "required": [
                                  "name",
                                  "path"
                                ],
                                "properties": {
                                  "default": {
                                    "type": "string",
                                    "nullable": true
                                  },
                                  "name": {
                                    "type": "string"
                                  },
                                  "path": {
                                    "type": "string"
                                  }
                                },
                                "additionalProperties": false
                              },
                              "nullable": true
                            },
                            "include_messages": {
                              "description": "Will include the error message in a \"message\" attribute",
                              "default": false,
                              "type": "boolean"
                            }
                          },
                          "additionalProperties": false,
                          "nullable": true
                        },
                        "request": {
                          "description": "Configuration to forward headers or body values from the request to custom attributes/labels in metrics",
                          "type": "object",
                          "properties": {
                            "body": {
                              "description": "Forward body values as custom attributes/labels in metrics",
                              "type": "array",
                              "items": {
                                "description": "Configuration to forward body values in metric attributes/labels",
                                "type": "object",
                                "required": [
                                  "name",
                                  "path"
                                ],
                                "properties": {
                                  "default": {
                                    "type": "string",
                                    "nullable": true
                                  },
                                  "name": {
                                    "type": "string"
                                  },
                                  "path": {
                                    "type": "string"
                                  }
                                },
                                "additionalProperties": false
                              },
                              "nullable": true
                            },
                            "header": {
                              "description": "Forward header values as custom attributes/labels in metrics",
                              "type": "array",
                              "items": {
                                "description": "Configuration to forward header values in metric labels",
                                "anyOf": [
                                  {
                                    "description": "Using a named header",
                                    "type": "object",
                                    "required": [
                                      "named"
                                    ],
                                    "properties": {
                                      "default": {
                                        "type": "string",
                                        "nullable": true
                                      },
                                      "named": {
                                        "type": "string"
                                      },
                                      "rename": {
                                        "type": "string",
                                        "nullable": true
                                      }
                                    },
                                    "additionalProperties": false
                                  },
                                  {
                                    "description": "Using a regex on the header name",
                                    "type": "object",
                                    "required": [
                                      "matching"
                                    ],
                                    "properties": {
                                      "matching": {
                                        "type": "string"
                                      }
                                    },
                                    "additionalProperties": false
                                  }
                                ]
                              },
                              "nullable": true
                            }
                          },
                          "additionalProperties": false,
                          "nullable": true
                        },
                        "response": {
                          "description": "Configuration to forward headers or body values from the response to custom attributes/labels in metrics",
                          "type": "object",
                          "properties": {
                            "body": {
                              "description": "Forward body values as custom attributes/labels in metrics",
                              "type": "array",
                              "items": {
                                "description": "Configuration to forward body values in metric attributes/labels",
                                "type": "object",
                                "required": [
                                  "name",
                                  "path"
                                ],
                                "properties": {
                                  "default": {
                                    "type": "string",
                                    "nullable": true
                                  },
                                  "name": {
                                    "type": "string"
                                  },
                                  "path": {
                                    "type": "string"
                                  }
                                },
                                "additionalProperties": false
                              },
                              "nullable": true
                            },
                            "header": {
                              "description": "Forward header values as custom attributes/labels in metrics",
                              "type": "array",
                              "items": {
                                "description": "Configuration to forward header values in metric labels",
                                "anyOf": [
                                  {
                                    "description": "Using a named header",
                                    "type": "object",
                                    "required": [
                                      "named"
                                    ],
                                    "properties": {
                                      "default": {
                                        "type": "string",
                                        "nullable": true
                                      },
                                      "named": {
                                        "type": "string"
                                      },
                                      "rename": {
                                        "type": "string",
                                        "nullable": true
                                      }
                                    },
                                    "additionalProperties": false
                                  },
                                  {
                                    "description": "Using a regex on the header name",
                                    "type": "object",
                                    "required": [
                                      "matching"
                                    ],
                                    "properties": {
                                      "matching": {
                                        "type": "string"
                                      }
                                    },
                                    "additionalProperties": false
                                  }
                                ]
                              },
                              "nullable": true
                            }
                          },
                          "additionalProperties": false,
                          "nullable": true
                        },
                        "static": {
                          "description": "Configuration to insert custom attributes/labels in metrics",
                          "type": "array",
                          "items": {
                            "description": "Configuration to insert custom attributes/labels in metrics",
                            "type": "object",
                            "required": [
                              "name",
                              "value"
                            ],
                            "properties": {
                              "name": {
                                "type": "string"
                              },
                              "value": {
                                "type": "string"
                              }
                            },
                            "additionalProperties": false
                          },
                          "nullable": true
                        }
                      },
                      "additionalProperties": false,
                      "nullable": true
                    },
                    "subgraph": {
                      "description": "Configuration to forward header values or body values from subgraph request/response in metric attributes/labels",
                      "type": "object",
                      "properties": {
                        "all": {
                          "type": "object",
                          "properties": {
                            "context": {
                              "description": "Configuration to forward values from the context to custom attributes/labels in metrics",
                              "type": "array",
                              "items": {
                                "description": "Configuration to forward context values in metric attributes/labels",
                                "type": "object",
                                "required": [
                                  "named"
                                ],
                                "properties": {
                                  "default": {
                                    "type": "string",
                                    "nullable": true
                                  },
                                  "named": {
                                    "type": "string"
                                  },
                                  "rename": {
                                    "type": "string",
                                    "nullable": true
                                  }
                                },
                                "additionalProperties": false
                              },
                              "nullable": true
                            },
                            "errors": {
                              "description": "Configuration to forward values from the error to custom attributes/labels in metrics",
                              "type": "object",
                              "properties": {
                                "extensions": {
                                  "description": "Forward extensions values as custom attributes/labels in metrics",
                                  "type": "array",
                                  "items": {
                                    "description": "Configuration to forward body values in metric attributes/labels",
                                    "type": "object",
                                    "required": [
                                      "name",
                                      "path"
                                    ],
                                    "properties": {
                                      "default": {
                                        "type": "string",
                                        "nullable": true
                                      },
                                      "name": {
                                        "type": "string"
                                      },
                                      "path": {
                                        "type": "string"
                                      }
                                    },
                                    "additionalProperties": false
                                  },
                                  "nullable": true
                                },
                                "include_messages": {
                                  "description": "Will include the error message in a \"message\" attribute",
                                  "default": false,
                                  "type": "boolean"
                                }
                              },
                              "additionalProperties": false,
                              "nullable": true
                            },
                            "request": {
                              "description": "Configuration to forward headers or body values from the request to custom attributes/labels in metrics",
                              "type": "object",
                              "properties": {
                                "body": {
                                  "description": "Forward body values as custom attributes/labels in metrics",
                                  "type": "array",
                                  "items": {
                                    "description": "Configuration to forward body values in metric attributes/labels",
                                    "type": "object",
                                    "required": [
                                      "name",
                                      "path"
                                    ],
                                    "properties": {
                                      "default": {
                                        "type": "string",
                                        "nullable": true
                                      },
                                      "name": {
                                        "type": "string"
                                      },
                                      "path": {
                                        "type": "string"
                                      }
                                    },
                                    "additionalProperties": false
                                  },
                                  "nullable": true
                                },
                                "header": {
                                  "description": "Forward header values as custom attributes/labels in metrics",
                                  "type": "array",
                                  "items": {
                                    "description": "Configuration to forward header values in metric labels",
                                    "anyOf": [
                                      {
                                        "description": "Using a named header",
                                        "type": "object",
                                        "required": [
                                          "named"
                                        ],
                                        "properties": {
                                          "default": {
                                            "type": "string",
                                            "nullable": true
                                          },
                                          "named": {
                                            "type": "string"
                                          },
                                          "rename": {
                                            "type": "string",
                                            "nullable": true
                                          }
                                        },
                                        "additionalProperties": false
                                      },
                                      {
                                        "description": "Using a regex on the header name",
                                        "type": "object",
                                        "required": [
                                          "matching"
                                        ],
                                        "properties": {
                                          "matching": {
                                            "type": "string"
                                          }
                                        },
                                        "additionalProperties": false
                                      }
                                    ]
                                  },
                                  "nullable": true
                                }
                              },
                              "additionalProperties": false,
                              "nullable": true
                            },
                            "response": {
                              "description": "Configuration to forward headers or body values from the response to custom attributes/labels in metrics",
                              "type": "object",
                              "properties": {
                                "body": {
                                  "description": "Forward body values as custom attributes/labels in metrics",
                                  "type": "array",
                                  "items": {
                                    "description": "Configuration to forward body values in metric attributes/labels",
                                    "type": "object",
                                    "required": [
                                      "name",
                                      "path"
                                    ],
                                    "properties": {
                                      "default": {
                                        "type": "string",
                                        "nullable": true
                                      },
                                      "name": {
                                        "type": "string"
                                      },
                                      "path": {
                                        "type": "string"
                                      }
                                    },
                                    "additionalProperties": false
                                  },
                                  "nullable": true
                                },
                                "header": {
                                  "description": "Forward header values as custom attributes/labels in metrics",
                                  "type": "array",
                                  "items": {
                                    "description": "Configuration to forward header values in metric labels",
                                    "anyOf": [
                                      {
                                        "description": "Using a named header",
                                        "type": "object",
                                        "required": [
                                          "named"
                                        ],
                                        "properties": {
                                          "default": {
                                            "type": "string",
                                            "nullable": true
                                          },
                                          "named": {
                                            "type": "string"
                                          },
                                          "rename": {
                                            "type": "string",
                                            "nullable": true
                                          }
                                        },
                                        "additionalProperties": false
                                      },
                                      {
                                        "description": "Using a regex on the header name",
                                        "type": "object",
                                        "required": [
                                          "matching"
                                        ],
                                        "properties": {
                                          "matching": {
                                            "type": "string"
                                          }
                                        },
                                        "additionalProperties": false
                                      }
                                    ]
                                  },
                                  "nullable": true
                                }
                              },
                              "additionalProperties": false,
                              "nullable": true
                            },
                            "static": {
                              "description": "Configuration to insert custom attributes/labels in metrics",
                              "type": "array",
                              "items": {
                                "description": "Configuration to insert custom attributes/labels in metrics",
                                "type": "object",
                                "required": [
                                  "name",
                                  "value"
                                ],
                                "properties": {
                                  "name": {
                                    "type": "string"
                                  },
                                  "value": {
                                    "type": "string"
                                  }
                                },
                                "additionalProperties": false
                              },
                              "nullable": true
                            }
                          },
                          "additionalProperties": false,
                          "nullable": true
                        },
                        "subgraphs": {
                          "type": "object",
                          "additionalProperties": {
                            "type": "object",
                            "properties": {
                              "context": {
                                "description": "Configuration to forward values from the context to custom attributes/labels in metrics",
                                "type": "array",
                                "items": {
                                  "description": "Configuration to forward context values in metric attributes/labels",
                                  "type": "object",
                                  "required": [
                                    "named"
                                  ],
                                  "properties": {
                                    "default": {
                                      "type": "string",
                                      "nullable": true
                                    },
                                    "named": {
                                      "type": "string"
                                    },
                                    "rename": {
                                      "type": "string",
                                      "nullable": true
                                    }
                                  },
                                  "additionalProperties": false
                                },
                                "nullable": true
                              },
                              "errors": {
                                "description": "Configuration to forward values from the error to custom attributes/labels in metrics",
                                "type": "object",
                                "properties": {
                                  "extensions": {
                                    "description": "Forward extensions values as custom attributes/labels in metrics",
                                    "type": "array",
                                    "items": {
                                      "description": "Configuration to forward body values in metric attributes/labels",
                                      "type": "object",
                                      "required": [
                                        "name",
                                        "path"
                                      ],
                                      "properties": {
                                        "default": {
                                          "type": "string",
                                          "nullable": true
                                        },
                                        "name": {
                                          "type": "string"
                                        },
                                        "path": {
                                          "type": "string"
                                        }
                                      },
                                      "additionalProperties": false
                                    },
                                    "nullable": true
                                  },
                                  "include_messages": {
                                    "description": "Will include the error message in a \"message\" attribute",
                                    "default": false,
                                    "type": "boolean"
                                  }
                                },
                                "additionalProperties": false,
                                "nullable": true
                              },
                              "request": {
                                "description": "Configuration to forward headers or body values from the request to custom attributes/labels in metrics",
                                "type": "object",
                                "properties": {
                                  "body": {
                                    "description": "Forward body values as custom attributes/labels in metrics",
                                    "type": "array",
                                    "items": {
                                      "description": "Configuration to forward body values in metric attributes/labels",
                                      "type": "object",
                                      "required": [
                                        "name",
                                        "path"
                                      ],
                                      "properties": {
                                        "default": {
                                          "type": "string",
                                          "nullable": true
                                        },
                                        "name": {
                                          "type": "string"
                                        },
                                        "path": {
                                          "type": "string"
                                        }
                                      },
                                      "additionalProperties": false
                                    },
                                    "nullable": true
                                  },
                                  "header": {
                                    "description": "Forward header values as custom attributes/labels in metrics",
                                    "type": "array",
                                    "items": {
                                      "description": "Configuration to forward header values in metric labels",
                                      "anyOf": [
                                        {
                                          "description": "Using a named header",
                                          "type": "object",
                                          "required": [
                                            "named"
                                          ],
                                          "properties": {
                                            "default": {
                                              "type": "string",
                                              "nullable": true
                                            },
                                            "named": {
                                              "type": "string"
                                            },
                                            "rename": {
                                              "type": "string",
                                              "nullable": true
                                            }
                                          },
                                          "additionalProperties": false
                                        },
                                        {
                                          "description": "Using a regex on the header name",
                                          "type": "object",
                                          "required": [
                                            "matching"
                                          ],
                                          "properties": {
                                            "matching": {
                                              "type": "string"
                                            }
                                          },
                                          "additionalProperties": false
                                        }
                                      ]
                                    },
                                    "nullable": true
                                  }
                                },
                                "additionalProperties": false,
                                "nullable": true
                              },
                              "response": {
                                "description": "Configuration to forward headers or body values from the response to custom attributes/labels in metrics",
                                "type": "object",
                                "properties": {
                                  "body": {
                                    "description": "Forward body values as custom attributes/labels in metrics",
                                    "type": "array",
                                    "items": {
                                      "description": "Configuration to forward body values in metric attributes/labels",
                                      "type": "object",
                                      "required": [
                                        "name",
                                        "path"
                                      ],
                                      "properties": {
                                        "default": {
                                          "type": "string",
                                          "nullable": true
                                        },
                                        "name": {
                                          "type": "string"
                                        },
                                        "path": {
                                          "type": "string"
                                        }
                                      },
                                      "additionalProperties": false
                                    },
                                    "nullable": true
                                  },
                                  "header": {
                                    "description": "Forward header values as custom attributes/labels in metrics",
                                    "type": "array",
                                    "items": {
                                      "description": "Configuration to forward header values in metric labels",
                                      "anyOf": [
                                        {
                                          "description": "Using a named header",
                                          "type": "object",
                                          "required": [
                                            "named"
                                          ],
                                          "properties": {
                                            "default": {
                                              "type": "string",
                                              "nullable": true
                                            },
                                            "named": {
                                              "type": "string"
                                            },
                                            "rename": {
                                              "type": "string",
                                              "nullable": true
                                            }
                                          },
                                          "additionalProperties": false
                                        },
                                        {
                                          "description": "Using a regex on the header name",
                                          "type": "object",
                                          "required": [
                                            "matching"
                                          ],
                                          "properties": {
                                            "matching": {
                                              "type": "string"
                                            }
                                          },
                                          "additionalProperties": false
                                        }
                                      ]
                                    },
                                    "nullable": true
                                  }
                                },
                                "additionalProperties": false,
                                "nullable": true
                              },
                              "static": {
                                "description": "Configuration to insert custom attributes/labels in metrics",
                                "type": "array",
                                "items": {
                                  "description": "Configuration to insert custom attributes/labels in metrics",
                                  "type": "object",
                                  "required": [
                                    "name",
                                    "value"
                                  ],
                                  "properties": {
                                    "name": {
                                      "type": "string"
                                    },
                                    "value": {
                                      "type": "string"
                                    }
                                  },
                                  "additionalProperties": false
                                },
                                "nullable": true
                              }
                            },
                            "additionalProperties": false
                          },
                          "nullable": true
                        }
                      },
                      "additionalProperties": false,
                      "nullable": true
                    }
                  },
                  "additionalProperties": false,
                  "nullable": true
                },
                "resources": {
                  "description": "Resources",
                  "default": {},
                  "type": "object",
                  "additionalProperties": {
                    "type": "string"
                  }
                },
                "service_name": {
                  "description": "Set a service.name resource in your metrics",
                  "type": "string",
                  "nullable": true
                },
                "service_namespace": {
                  "description": "Set a service.namespace attribute in your metrics",
                  "type": "string",
                  "nullable": true
                }
              },
              "additionalProperties": false,
              "nullable": true
            },
            "otlp": {
              "type": "object",
              "required": [
                "endpoint"
              ],
              "properties": {
                "endpoint": {
                  "type": "string"
                },
                "grpc": {
                  "type": "object",
                  "properties": {
                    "ca": {
                      "type": "string",
                      "nullable": true
                    },
                    "cert": {
                      "type": "string",
                      "nullable": true
                    },
                    "domain_name": {
                      "type": "string",
                      "nullable": true
                    },
                    "key": {
                      "type": "string",
                      "nullable": true
                    },
                    "metadata": {
                      "default": null,
                      "type": "object",
                      "additionalProperties": true,
                      "nullable": true
                    }
                  },
                  "additionalProperties": false,
                  "nullable": true
                },
                "http": {
                  "type": "object",
                  "properties": {
                    "headers": {
                      "type": "object",
                      "additionalProperties": {
                        "type": "string"
                      },
                      "nullable": true
                    }
                  },
                  "additionalProperties": false,
                  "nullable": true
                },
                "protocol": {
                  "type": "string",
                  "enum": [
                    "grpc",
                    "http"
                  ],
                  "nullable": true
                },
                "timeout": {
                  "default": null,
                  "type": "string"
                }
              },
              "additionalProperties": false,
              "nullable": true
            },
            "prometheus": {
              "type": "object",
              "required": [
                "enabled"
              ],
              "properties": {
                "enabled": {
                  "type": "boolean"
                },
                "listen": {
                  "description": "Listening address.",
                  "default": "127.0.0.1:9090",
                  "anyOf": [
                    {
                      "description": "Socket address.",
                      "type": "string"
                    },
                    {
                      "description": "Unix socket.",
                      "type": "string"
                    }
                  ]
                },
                "path": {
                  "default": "/metrics",
                  "type": "string"
                }
              },
              "additionalProperties": false,
              "nullable": true
            }
          },
          "additionalProperties": false,
          "nullable": true
        },
        "tracing": {
          "type": "object",
          "properties": {
            "datadog": {
              "type": "object",
              "properties": {
                "endpoint": {
                  "default": "default",
                  "type": "string"
                }
              },
              "additionalProperties": false,
              "nullable": true
            },
            "jaeger": {
              "type": "object",
              "oneOf": [
                {
                  "type": "object",
                  "required": [
                    "agent"
                  ],
                  "properties": {
                    "agent": {
                      "type": "object",
                      "properties": {
                        "endpoint": {
                          "default": "default",
                          "type": "string"
                        }
                      },
                      "additionalProperties": false
                    },
                    "scheduled_delay": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                },
                {
                  "type": "object",
                  "required": [
                    "collector"
                  ],
                  "properties": {
                    "collector": {
                      "type": "object",
                      "required": [
                        "endpoint"
                      ],
                      "properties": {
                        "endpoint": {
                          "type": "string"
                        },
                        "password": {
                          "type": "string",
                          "nullable": true
                        },
                        "username": {
                          "type": "string",
                          "nullable": true
                        }
                      },
                      "additionalProperties": false
                    },
                    "scheduled_delay": {
                      "type": "string"
                    }
                  },
                  "additionalProperties": false
                }
              ],
              "properties": {
                "scheduled_delay": {
                  "default": null,
                  "type": "string"
                }
              },
              "nullable": true
            },
            "otlp": {
              "type": "object",
              "required": [
                "endpoint"
              ],
              "properties": {
                "endpoint": {
                  "type": "string"
                },
                "grpc": {
                  "type": "object",
                  "properties": {
                    "ca": {
                      "type": "string",
                      "nullable": true
                    },
                    "cert": {
                      "type": "string",
                      "nullable": true
                    },
                    "domain_name": {
                      "type": "string",
                      "nullable": true
                    },
                    "key": {
                      "type": "string",
                      "nullable": true
                    },
                    "metadata": {
                      "default": null,
                      "type": "object",
                      "additionalProperties": true,
                      "nullable": true
                    }
                  },
                  "additionalProperties": false,
                  "nullable": true
                },
                "http": {
                  "type": "object",
                  "properties": {
                    "headers": {
                      "type": "object",
                      "additionalProperties": {
                        "type": "string"
                      },
                      "nullable": true
                    }
                  },
                  "additionalProperties": false,
                  "nullable": true
                },
                "protocol": {
                  "type": "string",
                  "enum": [
                    "grpc",
                    "http"
                  ],
                  "nullable": true
                },
                "timeout": {
                  "default": null,
                  "type": "string"
                }
              },
              "additionalProperties": false,
              "nullable": true
            },
            "propagation": {
              "type": "object",
              "properties": {
                "baggage": {
                  "type": "boolean",
                  "nullable": true
                },
                "datadog": {
                  "type": "boolean",
                  "nullable": true
                },
                "jaeger": {
                  "type": "boolean",
                  "nullable": true
                },
                "trace_context": {
                  "type": "boolean",
                  "nullable": true
                },
                "zipkin": {
                  "type": "boolean",
                  "nullable": true
                }
              },
              "additionalProperties": false,
              "nullable": true
            },
            "trace_config": {
              "type": "object",
              "properties": {
                "attributes": {
                  "type": "object",
                  "additionalProperties": {
                    "anyOf": [
                      {
                        "description": "bool values",
                        "type": "boolean"
                      },
                      {
                        "description": "i64 values",
                        "type": "integer",
                        "format": "int64"
                      },
                      {
                        "description": "f64 values",
                        "type": "number",
                        "format": "double"
                      },
                      {
                        "description": "String values",
                        "type": "string"
                      },
                      {
                        "description": "Array of homogeneous values",
                        "anyOf": [
                          {
                            "description": "Array of bools",
                            "type": "array",
                            "items": {
                              "type": "boolean"
                            }
                          },
                          {
                            "description": "Array of integers",
                            "type": "array",
                            "items": {
                              "type": "integer",
                              "format": "int64"
                            }
                          },
                          {
                            "description": "Array of floats",
                            "type": "array",
                            "items": {
                              "type": "number",
                              "format": "double"
                            }
                          },
                          {
                            "description": "Array of strings",
                            "type": "array",
                            "items": {
                              "type": "string"
                            }
                          }
                        ]
                      }
                    ]
                  },
                  "nullable": true
                },
                "max_attributes_per_event": {
                  "type": "integer",
                  "format": "uint32",
                  "minimum": 0.0,
                  "nullable": true
                },
                "max_attributes_per_link": {
                  "type": "integer",
                  "format": "uint32",
                  "minimum": 0.0,
                  "nullable": true
                },
                "max_attributes_per_span": {
                  "type": "integer",
                  "format": "uint32",
                  "minimum": 0.0,
                  "nullable": true
                },
                "max_events_per_span": {
                  "type": "integer",
                  "format": "uint32",
                  "minimum": 0.0,
                  "nullable": true
                },
                "max_links_per_span": {
                  "type": "integer",
                  "format": "uint32",
                  "minimum": 0.0,
                  "nullable": true
                },
                "parent_based_sampler": {
                  "type": "boolean",
                  "nullable": true
                },
                "sampler": {
                  "anyOf": [
                    {
                      "description": "Sample a given fraction. Fractions >= 1 will always sample.",
                      "type": "number",
                      "format": "double"
                    },
                    {
                      "oneOf": [
                        {
                          "description": "Always sample",
                          "type": "string",
                          "enum": [
                            "always_on"
                          ]
                        },
                        {
                          "description": "Never sample",
                          "type": "string",
                          "enum": [
                            "always_off"
                          ]
                        }
                      ]
                    }
                  ],
                  "nullable": true
                },
                "service_name": {
                  "type": "string",
                  "nullable": true
                },
                "service_namespace": {
                  "type": "string",
                  "nullable": true
                }
              },
              "additionalProperties": false,
              "nullable": true
            },
            "zipkin": {
              "type": "object",
              "properties": {
                "endpoint": {
                  "default": "default",
                  "type": "string"
                }
              },
              "additionalProperties": false,
              "nullable": true
            }
          },
          "additionalProperties": false,
          "nullable": true
        }
      },
      "additionalProperties": false
    },
    "test.always_fails_to_start": {
      "type": "object",
      "required": [
        "name"
      ],
      "properties": {
        "name": {
          "type": "string"
        }
      }
    },
    "test.always_starts_and_stops": {
      "type": "object",
      "required": [
        "name"
      ],
      "properties": {
        "name": {
          "type": "string"
        }
      }
    },
    "traffic_shaping": {
      "type": "object",
      "properties": {
        "all": {
          "description": "Applied on all subgraphs",
          "type": "object",
          "properties": {
            "compression": {
              "description": "Enable compression for subgraphs (available compressions are deflate, br, gzip)",
              "oneOf": [
                {
                  "description": "gzip",
                  "type": "string",
                  "enum": [
                    "gzip"
                  ]
                },
                {
                  "description": "deflate",
                  "type": "string",
                  "enum": [
                    "deflate"
                  ]
                },
                {
                  "description": "brotli",
                  "type": "string",
                  "enum": [
                    "br"
                  ]
                }
              ],
              "nullable": true
            },
            "deduplicate_query": {
              "description": "Enable query deduplication",
              "type": "boolean",
              "nullable": true
            },
            "global_rate_limit": {
              "description": "Enable global rate limiting",
              "type": "object",
              "required": [
                "capacity",
                "interval"
              ],
              "properties": {
                "capacity": {
                  "description": "Number of requests allowed",
                  "type": "integer",
                  "format": "uint64",
                  "minimum": 1.0
                },
                "interval": {
                  "description": "Per interval",
                  "type": "string"
                }
              },
              "additionalProperties": false,
              "nullable": true
            },
            "timeout": {
              "description": "Enable timeout for incoming requests",
              "default": null,
              "type": "string"
            }
          },
          "additionalProperties": false,
          "nullable": true
        },
        "deduplicate_variables": {
          "description": "Enable variable deduplication optimization when sending requests to subgraphs (https://github.com/apollographql/router/issues/87)",
          "type": "boolean",
          "nullable": true
        },
        "router": {
          "description": "Applied at the router level",
          "type": "object",
          "properties": {
            "global_rate_limit": {
              "description": "Enable global rate limiting",
              "type": "object",
              "required": [
                "capacity",
                "interval"
              ],
              "properties": {
                "capacity": {
                  "description": "Number of requests allowed",
                  "type": "integer",
                  "format": "uint64",
                  "minimum": 1.0
                },
                "interval": {
                  "description": "Per interval",
                  "type": "string"
                }
              },
              "additionalProperties": false,
              "nullable": true
            },
            "timeout": {
              "description": "Enable timeout for incoming requests",
              "default": null,
              "type": "string"
            }
          },
          "additionalProperties": false,
          "nullable": true
        },
        "subgraphs": {
          "description": "Applied on specific subgraphs",
          "type": "object",
          "additionalProperties": {
            "type": "object",
            "properties": {
              "compression": {
                "description": "Enable compression for subgraphs (available compressions are deflate, br, gzip)",
                "oneOf": [
                  {
                    "description": "gzip",
                    "type": "string",
                    "enum": [
                      "gzip"
                    ]
                  },
                  {
                    "description": "deflate",
                    "type": "string",
                    "enum": [
                      "deflate"
                    ]
                  },
                  {
                    "description": "brotli",
                    "type": "string",
                    "enum": [
                      "br"
                    ]
                  }
                ],
                "nullable": true
              },
              "deduplicate_query": {
                "description": "Enable query deduplication",
                "type": "boolean",
                "nullable": true
              },
              "global_rate_limit": {
                "description": "Enable global rate limiting",
                "type": "object",
                "required": [
                  "capacity",
                  "interval"
                ],
                "properties": {
                  "capacity": {
                    "description": "Number of requests allowed",
                    "type": "integer",
                    "format": "uint64",
                    "minimum": 1.0
                  },
                  "interval": {
                    "description": "Per interval",
                    "type": "string"
                  }
                },
                "additionalProperties": false,
                "nullable": true
              },
              "timeout": {
                "description": "Enable timeout for incoming requests",
                "default": null,
                "type": "string"
              }
            },
            "additionalProperties": false
          }
        }
      },
      "additionalProperties": false
    }
  }
}
