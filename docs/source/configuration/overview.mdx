---
title: Configuring the Apollo Router
description: High-performance graph routing for federated graphs
---

import { Link } from "gatsby";

> For installation instructions, see the [quickstart](../quickstart/).

You run Apollo Router with the following command (assuming you're in the same directory as the `router` executable):

```bash
./router --config configuration.yaml --supergraph supergraph-schema.graphql
```

Options are described below.

## Options

<table class="field-table api-ref">
  <thead>
    <tr>
      <th>Name</th>
      <th>Description</th>
    </tr>
  </thead>

<tbody>

<tr class="required">
<td>

##### `-s` / `--supergraph`

</td>
<td>

The path to the Apollo Router's [supergraph schema](https://www.apollographql.com/docs/federation/#federated-schemas),
absolute or relative to the current directory.

To learn how to compose your supergraph schema with the Rover CLI, see the [Federation quickstart](https://www.apollographql.com/docs/federation/quickstart/#3-compose-the-supergraph-schema).

**Required**

</td>
</tr>

<tr>
<td style="min-width: 150px;">

##### `-c` / `--config`

</td>
<td>

The absolute or relative path to the router's optional [YAML configuration file](#configuration-file).
</td>
</tr>

<tr>
<td style="min-width: 150px;">

##### `--log`

</td>
<td>

The log level, which can be one of: `off`, `error`, `warn`, `info`, `debug`, or `trace`.

Default: `info`

</td>
</tr>

<tr>
<td style="min-width: 150px;">

##### `--schema`

</td>
<td>

Prints out a JSON schema of the configuration file, including plugin configuration (see below)

</td>
</tr>

<tr>
<td style="min-width: 150px;">

##### `-w` / `--watch`

</td>
<td>

Watches for changes in the schema and configuration file, and reloads them automatically
without downtime

</td>
</tr>

<tr>
<td style="min-width: 150px;">

##### `-V` / `--version`

</td>
<td>

Prints out the Apollo Router's version

</td>
</tr>

</tbody>
</table>

## Configuration-awareness in your text editor

The Apollo Router is able to produce a JSON schema for use in your text editor. It significantly eases the burden of making
sure that your yaml file is correctly formatted, and even gives you content assist.

To generate the schema use:
```bash
router --schema > configuration_schema.json
```

One you have generated the schema configure your text editor. Here are some instructions for well known editors:
* [Emacs](https://emacs-lsp.github.io/lsp-mode/page/lsp-yaml)
* [IntelliJ](https://www.jetbrains.com/help/idea/json.html#ws_json_using_schemas)
* [Sublime](https://github.com/sublimelsp/LSP-yaml)
* [Vim](https://github.com/Quramy/vison)
* [VsCode](https://code.visualstudio.com/docs/languages/json#_json-schemas-and-settings)

## Configuration file

Apollo Router takes an optional YAML configuration file as input via the `--config` option. All supported configuration options are shown below:

### Listen address

By default, the Apollo Router starts a HTTP server listening on `127.0.0.1:4000`. This can be
changed in the configuration file:

```yaml title="configuration.router.yaml"
#
# server: Configuration of the HTTP server
#
server:
  # The socket address and port to listen on
  # Defaults to 127.0.0.1:4000
  listen: 127.0.0.1:4000
```

It can also listen on a Unix socket (not supported on Windows):

```yaml title="configuration.router.yaml"
server:
  # absolute path to a Unix socket
  listen: /tmp/router.sock

```

### Cross Origin Resource Sharing (CORS)

The Apollo Router can configure [Cross Origin Resource Sharing policies](../cors) throughits configuration file.

### OpenTelemetry tracing

The Apollo Router supports [OpenTelemetry](https://opentelemetry.io/), with exporters for
[Jaeger](https://www.jaegertracing.io/) and the
[OpenTelemetry Protocol (OTLP)](https://aws-otel.github.io/docs/components/otlp-exporter)
over HTTP or gRPC. The router generates traces that include the various phases of executing
a GraphQL operation and associated dependencies.

You can set it up in the configuration file's [OpenTelemetry section](../open-telemetry).

### Plugins

The Apollo Router can be customized through [plugins](../customizations/overview). Any plugin
can have its specific section in the configuration file:

```yaml title="configuration.router.yaml"
plugins:
  example.plugin:
    var1: "hello"
    var2: 1
```

To activate a plugin without configuration option, it can be added as follows:

```yaml title="configuration.router.yaml"
plugins:
  example.plugin:
```

### Avoiding repetition using YAML anchors and aliases

You can avoid repeating sections of configuration multiple times in your configuration file using standard YAML anchors and aliasing techniques:

```yaml {5,9} title="configuration.yaml"
headers:
  subgraphs:
    products:
      - insert: &insert_custom_header
          name: "custom-header"
          value: "something"
    reviews:
      - insert: *insert_custom_header
```

Here the content under `&insert_custom_header` would be reused under `*insert_custom_header`.
