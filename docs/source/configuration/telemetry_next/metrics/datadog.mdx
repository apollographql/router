---
title: Collecting metrics in the Apollo Router
---

## Datadog via OTLP

To use Datadog, you must configure the Datadog agent to accept OTLP metrics. This can be done by adding the following to your `datadog.yaml`:

```yaml title="datadog.yaml"
otlp_config:
  receiver:
    protocols:
      grpc:
        endpoint: <dd-agent-ip>:4317
```

The router must also be configured to send traces to the Datadog agent:

*Ensure that you set `temporality` to `delta`. Failure to do this will result in incorrect metrics.*

```yaml title="router.yaml"
telemetry:
  metrics:
    otlp:
      enabled: true
      # Temporality MUST be set to delta. Failure to do this will result in incorrect metrics.
      temporality: delta
      # Optional endpoint, either 'default' or a URL (Defaults to http://127.0.0.1:4317)
      endpoint: "${env.DATADOG_AGENT_HOST}:4317"
```

See [Datadog Agent configuration](https://docs.datadoghq.com/opentelemetry/otlp_ingest_in_the_agent/?tab=host) for more details
