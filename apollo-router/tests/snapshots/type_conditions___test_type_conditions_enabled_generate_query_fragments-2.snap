---
source: apollo-router/tests/type_conditions.rs
expression: response
---
{
  "data": {
    "search": null
  },
  "errors": [
    {
      "message": "couldn't find mock for query {\"query\":\"{ search { __typename ..._generated_onMovieResult_2_0 ..._generated_onArticleResult_2_0 } } fragment _generated_onEntityCollectionSection_2_0 on EntityCollectionSection { __typename id } fragment _generated_onGallerySection_2_0 on GallerySection { __typename id } fragment _generated_onMovieResult_2_0 on MovieResult { sections { __typename ..._generated_onEntityCollectionSection_2_0 ..._generated_onGallerySection_2_0 } id } fragment _generated_onArticleResult_2_0 on ArticleResult { id sections { __typename ..._generated_onGallerySection_2_0 ..._generated_onEntityCollectionSection_2_0 } }\"}",
      "extensions": {
        "code": "FETCH_ERROR"
      }
    }
  ],
  "extensions": {
    "apolloQueryPlan": {
      "object": {
        "kind": "QueryPlan",
        "node": {
          "kind": "Sequence",
          "nodes": [
            {
              "kind": "Fetch",
              "serviceName": "searchSubgraph",
              "variableUsages": [],
              "operation": "query Search__searchSubgraph__0 {\n  search {\n    __typename\n    ..._generated_onMovieResult_2_0\n    ..._generated_onArticleResult_2_0\n  }\n}\n\nfragment _generated_onEntityCollectionSection_2_0 on EntityCollectionSection {\n  __typename\n  id\n}\n\nfragment _generated_onGallerySection_2_0 on GallerySection {\n  __typename\n  id\n}\n\nfragment _generated_onMovieResult_2_0 on MovieResult {\n  sections {\n    __typename\n    ..._generated_onEntityCollectionSection_2_0\n    ..._generated_onGallerySection_2_0\n  }\n  id\n}\n\nfragment _generated_onArticleResult_2_0 on ArticleResult {\n  id\n  sections {\n    __typename\n    ..._generated_onGallerySection_2_0\n    ..._generated_onEntityCollectionSection_2_0\n  }\n}\n",
              "operationName": "Search__searchSubgraph__0",
              "operationKind": "query",
              "id": null,
              "inputRewrites": null,
              "outputRewrites": null,
              "contextRewrites": null,
              "schemaAwareHash": "76c2644d2c4d6fc5398795437e06b139ec6ea0a333a29e25d9cb3b7f1753cc2a",
              "authorization": {
                "is_authenticated": false,
                "scopes": [],
                "policies": []
              }
            },
            {
              "kind": "Parallel",
              "nodes": [
                {
                  "kind": "Flatten",
                  "path": [
                    "search",
                    "@|[ArticleResult]",
                    "sections",
                    "@"
                  ],
                  "node": {
                    "kind": "Fetch",
                    "serviceName": "artworkSubgraph",
                    "requires": [
                      {
                        "kind": "InlineFragment",
                        "typeCondition": "GallerySection",
                        "selections": [
                          {
                            "kind": "Field",
                            "name": "__typename"
                          },
                          {
                            "kind": "Field",
                            "name": "id"
                          }
                        ]
                      },
                      {
                        "kind": "InlineFragment",
                        "typeCondition": "EntityCollectionSection",
                        "selections": [
                          {
                            "kind": "Field",
                            "name": "__typename"
                          },
                          {
                            "kind": "Field",
                            "name": "id"
                          }
                        ]
                      }
                    ],
                    "variableUsages": [
                      "articleResultParam"
                    ],
                    "operation": "query Search__artworkSubgraph__1($representations: [_Any!]!, $articleResultParam: String) {\n  _entities(representations: $representations) {\n    ... on GallerySection {\n      artwork(params: $articleResultParam)\n    }\n    ..._generated_onEntityCollectionSection_2_0\n  }\n}\n\nfragment _generated_onEntityCollectionSection_2_0 on EntityCollectionSection {\n  artwork(params: $articleResultParam)\n  title\n}\n",
                    "operationName": "Search__artworkSubgraph__1",
                    "operationKind": "query",
                    "id": null,
                    "inputRewrites": null,
                    "outputRewrites": null,
                    "contextRewrites": null,
                    "schemaAwareHash": "006fc974883efa8ebe2fbd85e41b2835947a09e9e283ce5c11d441cd634236c7",
                    "authorization": {
                      "is_authenticated": false,
                      "scopes": [],
                      "policies": []
                    }
                  }
                },
                {
                  "kind": "Flatten",
                  "path": [
                    "search",
                    "@|[MovieResult]",
                    "sections",
                    "@"
                  ],
                  "node": {
                    "kind": "Fetch",
                    "serviceName": "artworkSubgraph",
                    "requires": [
                      {
                        "kind": "InlineFragment",
                        "typeCondition": "EntityCollectionSection",
                        "selections": [
                          {
                            "kind": "Field",
                            "name": "__typename"
                          },
                          {
                            "kind": "Field",
                            "name": "id"
                          }
                        ]
                      },
                      {
                        "kind": "InlineFragment",
                        "typeCondition": "GallerySection",
                        "selections": [
                          {
                            "kind": "Field",
                            "name": "__typename"
                          },
                          {
                            "kind": "Field",
                            "name": "id"
                          }
                        ]
                      }
                    ],
                    "variableUsages": [
                      "movieResultParam"
                    ],
                    "operation": "query Search__artworkSubgraph__2($representations: [_Any!]!, $movieResultParam: String) {\n  _entities(representations: $representations) {\n    ..._generated_onEntityCollectionSection_2_0\n    ... on GallerySection {\n      artwork(params: $movieResultParam)\n    }\n  }\n}\n\nfragment _generated_onEntityCollectionSection_2_0 on EntityCollectionSection {\n  title\n  artwork(params: $movieResultParam)\n}\n",
                    "operationName": "Search__artworkSubgraph__2",
                    "operationKind": "query",
                    "id": null,
                    "inputRewrites": null,
                    "outputRewrites": null,
                    "contextRewrites": null,
                    "schemaAwareHash": "92abc3f8da66ab97129dfa9f72e3ebee18875d961a6bbafbca0eb9275112710f",
                    "authorization": {
                      "is_authenticated": false,
                      "scopes": [],
                      "policies": []
                    }
                  }
                }
              ]
            }
          ]
        }
      },
      "text": "QueryPlan {\n  Sequence {\n    Fetch(service: \"searchSubgraph\") {\n      {\n        search {\n          __typename\n          ..._generated_onMovieResult_2_0\n          ..._generated_onArticleResult_2_0\n        }\n      }\n\n      fragment _generated_onEntityCollectionSection_2_0 on EntityCollectionSection {\n        __typename\n        id\n      }\n\n      fragment _generated_onGallerySection_2_0 on GallerySection {\n        __typename\n        id\n      }\n\n      fragment _generated_onMovieResult_2_0 on MovieResult {\n        sections {\n          __typename\n          ..._generated_onEntityCollectionSection_2_0\n          ..._generated_onGallerySection_2_0\n        }\n        id\n      }\n\n      fragment _generated_onArticleResult_2_0 on ArticleResult {\n        id\n        sections {\n          __typename\n          ..._generated_onGallerySection_2_0\n          ..._generated_onEntityCollectionSection_2_0\n        }\n      }\n    },\n    Parallel {\n      Flatten(path: \"search.@|[ArticleResult].sections.@\") {\n        Fetch(service: \"artworkSubgraph\") {\n          {\n            ... on GallerySection {\n              __typename\n              id\n            }\n            ... on EntityCollectionSection {\n              __typename\n              id\n            }\n          } =>\n          {\n            ... on GallerySection {\n              artwork(params: $articleResultParam)\n            }\n            ..._generated_onEntityCollectionSection_2_0\n          }\n\n          fragment _generated_onEntityCollectionSection_2_0 on EntityCollectionSection {\n            artwork(params: $articleResultParam)\n            title\n          }\n        },\n      },\n      Flatten(path: \"search.@|[MovieResult].sections.@\") {\n        Fetch(service: \"artworkSubgraph\") {\n          {\n            ... on EntityCollectionSection {\n              __typename\n              id\n            }\n            ... on GallerySection {\n              __typename\n              id\n            }\n          } =>\n          {\n            ..._generated_onEntityCollectionSection_2_0\n            ... on GallerySection {\n              artwork(params: $movieResultParam)\n            }\n          }\n\n          fragment _generated_onEntityCollectionSection_2_0 on EntityCollectionSection {\n            title\n            artwork(params: $movieResultParam)\n          }\n        },\n      },\n    },\n  },\n}"
    }
  }
}
