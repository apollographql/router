---
title: Logging format
---

## Logging format
Logging can be configured to output in a variety of different formats. Each with their own configuration options.

### `text`
Text format is a human-readable format ideal for development and debugging.

```yaml title="router.yaml"
telemetry:
  logging:
    stdout:
      enabled: true
      format: text # The default text format will be used
```


`text` can also be used as a key in the yaml to specify advanced configuration options:
```yaml title="router.yaml"
telemetry:
  logging:
    stdout:
      enabled: true
      format:
        text:
          flavor: compact
          ansi: false
          display_filename: true
          display_level: true
          display_line_number: true
          display_target: true
          display_thread_id: true
          display_thread_name: true
          display_timestamp: true
```

Example output:
```json
2023-10-30T15:49:34.174435Z  INFO main ThreadId(01) span_name{span_attr_1="span_attr_1" span_attr_2="span_attr_2"}: event_target: event_file.rs:32: event_attr_1="event_attr_1" event_attr_2="event_attr_2"
```

#### `flavor`

You may choose a between `default`, `pretty` or `compact` formatting for text output by setting the `flavor` key in router.yaml:

##### `default` (default)
```yaml title="router.yaml"
telemetry:
  logging:
    stdout:
      enabled: true
      format:
        text:
          flavor: default
```
Example output
```
2023-10-30T15:54:48.563180Z  INFO span_name{span_attr_1="span_attr_1" span_attr_2="span_attr_2"}: event_target: event_attr_1="event_attr_1" event_attr_2="event_attr_2"
```

##### `pretty`
```yaml title="router.yaml"
telemetry:
  logging:
    stdout:
      enabled: true
      format:
        text:
          flavor: default
```
Example output
```
  2023-10-30T15:56:26.478213Z  INFO event_target: event_attr_1: "event_attr_1", event_attr_2: "event_attr_2"
    at event_file.rs:32
    in span_target::span_name with span_attr_1: "span_attr_1", span_attr_2: "span_attr_2"

```

##### `compact`
```yaml title="router.yaml"
telemetry:
  logging:
    stdout:
      enabled: true
      format:
        text:
          flavor: default
```
Example output
```
2023-10-30T15:56:57.717627Z  INFO span_name: event_target: event_attr_1="event_attr_1" event_attr_2="event_attr_2" span_attr_1="span_attr_1" span_attr_2="span_attr_2"
```


#### Configuration reference
| Option                | Values                         | Default   | Description                                                |
|-----------------------|--------------------------------|-----------|------------------------------------------------------------|
| `flavor`              | `default`\|`compact`\|`pretty` | `default` | The overall output formatting.                             |
| `ansi`                | `true`\|`false`                | `false`   | Use ansi terminal escape codes.                            |
| `display_filename`    | `true`\|`false`                | `false`   | The filename where the log event was raised.               |
| `display_level`       | `true`\|`false`                | `true`    | The level of the log event, e.g. INFO, WARN, ERROR, TRACE. |
| `display_line_number` | `true`\|`false`                | `false`   | The line number where the event was raised.                |
| `display_target`      | `true`\|`false`                | `false`   | The module name where the event was raised.                |
| `display_thread_id`   | `true`\|`false`                | `false`   | The id of the thread where the event was raised.           |
| `display_thread_name` | `true`\|`false`                | `false`   | The name of the thread where the event was raised.         |
| `display_timestamp`   | `true`\|`false`                | `true`    | The timestamp of when the event was raised.                |


### `json`

Json format is a machine-readable format idea for consumption by APMs.

The router supports structured JSON output provided by [tracing-subscriber](https://docs.rs/tracing-subscriber/latest/tracing_subscriber/fmt/format/struct.Json.html).

```yaml title="router.yaml"
telemetry:
  logging:
    stdout:
      enabled: true
      format: json
```

Each log entry will be a single well formed JSON document, that is ideal for processing in your APM tool of choice.

Example default JSON output (pretty printed):
```json title="stdout"
{
  "timestamp": "2023-10-30T14:09:34.771388Z",
  "level": "INFO",
  "fields": {
    "event_attr_1": "event_attr_1",
    "event_attr_2": "event_attr_2"
  },
  "target": "event_target"
}
```

You can configure which attributes are included in the JSON output by specifying `json` as a key in the router yaml:

```yaml title="router.yaml"
telemetry:
  logging:
    stdout:
      enabled: true
      format: 
        json:
          display_filename: false
          display_level: true
          display_line_number: false
          display_target: false
          display_thread_id: false
          display_thread_name: false
          display_timestamp: true
          flatten_event: false
          display_current_span: true
          display_span_list: true
```

Example output:
```json
{
  "timestamp": "2023-10-30T15:47:52.570482Z",
  "level": "INFO",
  "fields": {
    "event_attr_1": "event_attr_1",
    "event_attr_2": "event_attr_2"
  },
  "target": "event_target",
  "filename": "event_file.rs",
  "line_number": 32,
  "span": {
    "span_attr_1": "span_attr_1",
    "span_attr_2": "span_attr_2",
    "name": "span_name"
  },
  "spans": [
    {
      "span_attr_1": "span_attr_1",
      "span_attr_2": "span_attr_2",
      "name": "span_name"
    }
  ],
  "threadName": "main",
  "threadId": "ThreadId(1)"
}
```

#### `flatten_event`
Flatten event can be used to eliminate the fields attribute and output event fields directly on the root json object. This is useful if you want to ingest the logs into a tool that doesn't support nested json objects.

Configuration
```yaml title="router.yaml"
telemetry:
  logging:
    stdout:
      enabled: true
      format: 
        json:
          flatten_event: true
```


Example output:
```yaml
{
  "timestamp": "2023-10-30T14:09:34.771388Z",
  "level": "INFO",
  "event_attr_1": "event_attr_1",
  "event_attr_2": "event_attr_2",
  "target": "event_target"
}
```

#### `display_current_span`
Events contain may also output information about the span that they are raised in. This is useful if you have attached attributes to the span that you want to include in the log output for a particular request.

Set the `display_current_span` configuration option to `true`.
```yaml title="router.yaml"
telemetry:
  logging:
    stdout:
      enabled: true
      format: 
        json:
          display_current_span: true
```

Example output:
```yaml
{
  "timestamp": "2023-10-30T14:09:34.771388Z",
  "level": "INFO",
  "fields": {
    "event_attr_1": "event_attr_1",
    "event_attr_2": "event_attr_2"
  },
  "target": "event_target",
  "span": {
    "span_attr_1": "span_attr_1",
    "span_attr_2": "span_attr_2",
    "name": "span_name"
  }
}
```


### `display_span_list`
Events contain may also output information about the span(s) that they are raised in.
This is useful if you have attached attributes to the span that you want to include in all log output for a particular request.

For instance, if you have a custom `trace_id` from a request header, as long as the attribute is configured on the `router` span it will appear on all log events associated with the request.

Set the `display_current_span` configuration option to `true`.
```yaml title="router.yaml"
telemetry:
  logging:
    stdout:
      enabled: true
      format: 
        json:
          display_span_list: true
```

Example output:
```yaml
{
  "timestamp": "2023-10-30T14:09:34.771388Z",
  "level": "INFO",
  "fields": {
    "event_attr_1": "event_attr_1",
    "event_attr_2": "event_attr_2"
  },
  "target": "event_target",
  "spans": [
    {
      "span_attr_1": "span_attr_1",
      "span_attr_2": "span_attr_2",
      "name": "span_name"
    }
  ]
}
```



#### Configuration reference
| Option                 | Values            | Default | Event Field   | Description                                                                            |
|------------------------|-------------------|---------|:--------------|----------------------------------------------------------------------------------------|
| `current_span`         | `true`\|`false`   | `false` | `span`        | The span in which the event was raised and all of its' attributes.                     |
| `display_filename`     | `true`\|`false`   | `false` | `filename`    | The filename where the log event was raised.                                           |
| `display_level`        | `true`\|`false`   | `true`  | `level`       | The level of the log event, e.g. INFO, WARN, ERROR, TRACE.                             |
| `display_line_number`  | `true`\|`false`   | `false` | `line_number` | The line number where the event was raised.                                            |
| `display_target`       | `true`\|`false`   | `false` | `target`      | The module name where the event was raised.                                            |
| `display_thread_id`    | `true`\|`false`   | `false` | `thread_id`   | The id of the thread where the event was raised.                                       |
| `display_thread_name`  | `true`\|`false`   | `false` | `thread_name` | The name of the thread where the event was raised.                                     |
| `display_timestamp`    | `true`\|`false`   | `true`  | `timestamp`   | The timestamp of when the event was raised.                                            |
| `flatten_event`        | `true`\|`false`   | `false` |               | Instead output event fields directly on the root json object, see documentation above. |
| `span_list`            | `true`\|`false`   | `false` | `spans`       | A list of all spans to root in which the event was raised and all of their attributes. |
